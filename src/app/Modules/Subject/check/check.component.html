<div class="header">
    <h1 style="text-align: center;">Checking</h1>
    <div class="button-group">
      <a [routerLink]="['/main/Subject/main/subject/modulesmain/', subjectID, 'modules', moduleID, 'mat']"  routerLinkActive="active">
          <button class="nav-btn">Learning Material</button>
      </a>
      <!-- <a [routerLink]="[ '/main/Subject/main/subject/modulesmain/:id/modules/assess']"  routerLinkActive="active"> -->
          <a [routerLink]="['/main/Subject/main/subject/modulesmain/', subjectID, 'modules', moduleID, 'assess']"  routerLinkActive="active">
          <button class="nav-btn">Assessment</button>
      </a>
      <a [routerLink]="['/main/Subject/main/subject/modulesmain/', subjectID, 'modules', moduleID, 'discuss']"  routerLinkActive="active">
          <button class="nav-btn">Discussion</button>
      </a>
  </div>
  </div>
  <!-- <div class="modules">
    <div class="module" *ngFor="let answer of studentAnswers">
        <div class="p-6 bg-background text-foreground">
            <div class="header-container">
                <h2 class="text-xl font-bold mb-4">{{ det.title }}</h2>
                <div class="student-info">
                    <span class="student-count">Student's Answer for Question: {{ answer.question }}</span>
                </div>
            </div>

            <ol class="list-decimal list-inside space-y-4">
                <li>
                    <div>
                        <strong>{{ answer.question }}</strong>
                        Check if the question is multiple choice and display the student's answer
                        <div *ngIf="answer.type === 'multiple-choice'" class="input-wrapper">
                            <div *ngFor="let option of answer.options; let i = index">
                                <label>
                                    <input type="radio" name="q{{answer.question_id}}" [value]="i + 1" [checked]="answer.student_answer === option">
                                    {{ getLetter(i) }}. {{ option }}
                                </label>
                            </div>
                        </div>

                        True/False question type
                        <div *ngIf="answer.type === 'true-false'" class="input-wrapper">
                            <label>
                                <input type="radio" name="q{{answer.question_id}}" value="true" [checked]="answer.student_answer === 'true'"> True
                            </label>
                            <label>
                                <input type="radio" name="q{{answer.question_id}}" value="false" [checked]="answer.student_answer === 'false'"> False
                            </label>
                        </div>

                        Identification and other types
                        <div *ngIf="answer.type !== 'multiple-choice' && answer.type !== 'true-false'" class="input-wrapper">
                            <input type="text" name="q{{answer.question_id}}" [value]="answer.student_answer" disabled>
                        </div>

                        Display the correct answer and score
                        <p><strong>Correct Answer:</strong> {{ answer.key_answer }}</p>
                        <p><strong>Score:</strong> {{ answer.score }}</p>
                    </div>
                </li>
            </ol>
        </div>
    </div>
</div> -->

<div class="modules">
  <div class="module">
      <div class="p-6 bg-background text-foreground">
          <div class="header-container">
              <h2 class="text-xl font-bold mb-4">{{ det.title }}</h2>
              <h2 class="text-xl font-bold mb-4">Total Score: {{ studScore.score }}/{{ maxScore }}</h2>
              <!-- <div class="student-info">
                  <span class="student-count">Students Completed: {{ completedCount }}/{{ totalStudents }}</span>
                  <a (click)="navigateToProgress()">
                      <span class="eye-icon"><i class="fa fa-eye"></i></span>
                  </a>
              </div> -->
          </div>
          <p class="mb-4">
              {{ det.instruction }}
          </p>

          <!-- Loop through the questions array -->
          <ol class="list-decimal list-inside space-y-4">
            <li *ngFor="let answer of studentAnswers">
                <div>
                    <!-- <strong>{{ answer.question }} </strong> <p><strong>points:</strong> {{ answer.points }}</p> -->

                    <h6><strong>{{ answer.question }} </strong> <u style="color: red;">points: {{ answer.points }}</u></h6>
                    
                    <!-- Display essay answer -->
                    <div *ngIf="answer.type === 'Essay'" class="input-wrapper">
                        <textarea style="width: 600px;" name="q{{answer.question_id}}" [value]="answer.student_answer" disabled></textarea>

                        <!-- Teacher input to give a score -->
                        <div *ngIf="isTeacher" class="score-input">
                            <label for="score">Give Score:</label>
                            <input type="number" [(ngModel)]="answer.score" name="score" min="0" max="{{ answer.max_score }}">
                            <button class="nav-btn2" (click)="manualCheck(answer.question_id, answer.score)">Submit Score</button>
                        </div>
                    </div>

                    <!-- <div *ngIf="answer.type === 'Essay'" class="input-wrapper">
                        <textarea style="width: 600px;" name="q{{answer.question_id}}" [value]="answer.student_answer" disabled></textarea>
                    
                        Teacher input to give a score
                        <div *ngIf="isTeacher" class="score-input">
                            <label for="score">Give Score:</label>
                            <input type="number" [(ngModel)]="answer.score" name="score" min="0" max="{{ answer.max_score }}">
                            
                            Disable Submit button if there is no student answer
                            <button class="nav-btn2" 
                                    (click)="manualCheck(answer.question_id, answer.score)" 
                                    [disabled]="!answer.student_answer || answer.student_answer.trim() === ''">
                                Submit Score
                            </button>
                        </div>
                    </div> -->

                    <!-- Identification and other types -->
                    <div *ngIf="answer.type !== 'Essay'" class="input-wrapper">
                        <!-- <input type="text" name="q{{answer.question_id}}" [value]="answer.student_answer" disabled> -->
                        <textarea style="width: 600px;" name="q{{answer.question_id}}" [value]="answer.student_answer" disabled></textarea>
                    </div>

                    <!-- Display correct answer and score only if the question type is NOT Essay -->
                    <div *ngIf="answer.type !== 'Essay'">
                        <p><strong>Correct Answer:</strong> {{ answer.key_answer }}</p>
                        <p><strong>Score:</strong> {{ answer.score }}</p>
                        <!-- <p><strong>points:</strong> {{ answer.points }}</p> -->
                    </div>
                </div>
            </li>
        </ol>
      </div>
  </div>
</div>